{"ast":null,"code":"var _jsxFileName = \"D:\\\\RaDaR\\\\React\\\\full-shop\\\\client\\\\src\\\\components\\\\CreateProduct.js\",\n    _s = $RefreshSig$();\n\nimport { Modal, Button, Form, Row, Col } from 'react-bootstrap';\nimport { createProduct, fetchCategories, fetchBrands, fetchMechanisms, fetchGenders } from '../http/catalogAPI.js';\nimport { useState, useEffect } from 'react';\nimport CreateProperties from './CreateProperties.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst defaultValue = {\n  name: '',\n  price: '',\n  category: '',\n  brand: '',\n  mechanism: '',\n  gender: '',\n  shape: ''\n};\nconst defaultValid = {\n  name: null,\n  price: null,\n  category: null,\n  brand: null,\n  mechanism: null,\n  gender: null,\n  shape: null\n};\n\nconst isValid = value => {\n  const result = {};\n  const pattern = /^[1-9][0-9]*$/;\n\n  for (let key in value) {\n    if (key === 'name') result.name = value.name.trim() !== '';\n    if (key === 'price') result.price = pattern.test(value.price.trim());\n    if (key === 'category') result.category = pattern.test(value.category);\n    if (key === 'brand') result.brand = pattern.test(value.brand);\n    if (key === 'mechanism') result.mechanism = pattern.test(value.mechanism);\n    if (key === 'gender') result.gender = pattern.test(value.gender);\n    if (key === 'shape') result.shape = pattern.test(value.shape);\n  }\n\n  return result;\n};\n\nconst CreateProduct = props => {\n  _s();\n\n  const {\n    show,\n    setShow,\n    setChange\n  } = props;\n  const [value, setValue] = useState(defaultValue);\n  const [valid, setValid] = useState(defaultValid);\n  const [image, setImage] = useState(null);\n  const [properties, setProperties] = useState([]);\n  const [categories, setCategories] = useState(null);\n  const [brands, setBrands] = useState(null);\n  const [mechanisms, setMechanisms] = useState(null);\n  const [genders, setGenders] = useState(null);\n  const [shapes, setShapes] = useState(null);\n  useEffect(() => {\n    fetchCategories().then(data => setCategories(data));\n    fetchBrands().then(data => setBrands(data));\n    fetchMechanisms().then(data => setMechanisms(data));\n    fetchGenders().then(data => setGenders(data));\n    fetchShapes().then(data => setShapes(data));\n  }, []);\n\n  const handleInputChange = event => {\n    const data = { ...value,\n      [event.target.name]: event.target.value\n    };\n    setValue(data);\n    setValid(isValid(data));\n  };\n\n  const handleImageChange = event => {\n    setImage(event.target.files[0]);\n  };\n\n  const handleSubmit = event => {\n    event.preventDefault();\n    const correct = isValid(value);\n    setValid(correct);\n\n    if (correct.name && correct.price && correct.category && correct.brand && correct.mechanism && correct.gender && correct.shape) {\n      const data = new FormData();\n      data.append('name', value.name.trim());\n      data.append('price', value.price.trim());\n      data.append('categoryId', value.category);\n      data.append('brandId', value.brand);\n      data.append('mechanismId', value.mechanism);\n      data.append('genderId', value.gender);\n      data.append('shapeId', value.shape);\n      if (image) data.append('image', image, image.name);\n\n      if (properties.length) {\n        const props = properties.filter(prop => prop.name.trim() !== '' && prop.value.trim() !== '');\n\n        if (props.length) {\n          data.append('props', JSON.stringify(props));\n        }\n      }\n\n      createProduct(data).then(data => {\n        event.target.image.value = '';\n        setValue(defaultValue);\n        setValid(defaultValid);\n        setProperties([]);\n        setShow(false);\n        setChange(state => !state);\n      }).catch(error => alert(error.response.data.message));\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    show: show,\n    onHide: () => setShow(false),\n    size: \"lg\",\n    children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n      closeButton: true,\n      children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n        children: \"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u0442\\u043E\\u0432\\u0430\\u0440\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        noValidate: true,\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(Form.Control, {\n          name: \"name\",\n          value: value.name,\n          onChange: e => handleInputChange(e),\n          isValid: valid.name === true,\n          isInvalid: valid.name === false,\n          placeholder: \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430...\",\n          className: \"mb-3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(Form.Select, {\n              name: \"category\",\n              value: value.category,\n              onChange: e => handleInputChange(e),\n              isValid: valid.category === true,\n              isInvalid: valid.category === false,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 33\n              }, this), categories && categories.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: item.id,\n                children: item.name\n              }, item.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 37\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(Form.Select, {\n              name: \"brand\",\n              value: value.brand,\n              onChange: e => handleInputChange(e),\n              isValid: valid.brand === true,\n              isInvalid: valid.brand === false,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\u0411\\u0440\\u0435\\u043D\\u0434\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 33\n              }, this), brands && brands.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: item.id,\n                children: item.name\n              }, item.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 37\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(Form.Select, {\n              name: \"mechanism\",\n              value: value.mechanism,\n              onChange: e => handleInputChange(e),\n              isValid: valid.mechanism === true,\n              isInvalid: valid.mechanism === false,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\u0422\\u0438\\u043F \\u043C\\u0435\\u0445\\u0430\\u043D\\u0438\\u0437\\u043C\\u0430\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 33\n              }, this), mechanisms && mechanisms.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: item.id,\n                children: item.name\n              }, item.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 37\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(Form.Select, {\n              name: \"gender\",\n              value: value.gender,\n              onChange: e => handleInputChange(e),\n              isValid: valid.gender === true,\n              isInvalid: valid.gender === false,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\u041F\\u043E\\u043B\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 33\n              }, this), genders && genders.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: item.id,\n                children: item.name\n              }, item.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 181,\n                columnNumber: 37\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(Form.Select, {\n              name: \"shape\",\n              value: value.shape,\n              onChange: e => handleInputChange(e),\n              isValid: valid.shape === true,\n              isInvalid: valid.shape === false,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\u0424\\u043E\\u0440\\u043C\\u0430 \\u043A\\u043E\\u0440\\u043F\\u0443\\u0441\\u0430\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 33\n              }, this), shapes && shapes.map(item => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: item.id,\n                children: item.name\n              }, item.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 37\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(Form.Control, {\n              name: \"price\",\n              value: value.price,\n              onChange: e => handleInputChange(e),\n              isValid: valid.price === true,\n              isInvalid: valid.price === false,\n              placeholder: \"\\u0426\\u0435\\u043D\\u0430 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(Form.Control, {\n              name: \"image\",\n              type: \"file\",\n              onChange: e => handleImageChange(e),\n              placeholder: \"\\u0424\\u043E\\u0442\\u043E \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(CreateProperties, {\n          properties: properties,\n          setProperties: setProperties\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              type: \"submit\",\n              children: \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 9\n  }, this);\n};\n\n_s(CreateProduct, \"sTm7/nZVtKXWHzLG0qew0fLquMg=\");\n\n_c = CreateProduct;\nexport default CreateProduct;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateProduct\");","map":{"version":3,"sources":["D:/RaDaR/React/full-shop/client/src/components/CreateProduct.js"],"names":["Modal","Button","Form","Row","Col","createProduct","fetchCategories","fetchBrands","fetchMechanisms","fetchGenders","useState","useEffect","CreateProperties","defaultValue","name","price","category","brand","mechanism","gender","shape","defaultValid","isValid","value","result","pattern","key","trim","test","CreateProduct","props","show","setShow","setChange","setValue","valid","setValid","image","setImage","properties","setProperties","categories","setCategories","brands","setBrands","mechanisms","setMechanisms","genders","setGenders","shapes","setShapes","then","data","fetchShapes","handleInputChange","event","target","handleImageChange","files","handleSubmit","preventDefault","correct","FormData","append","length","filter","prop","JSON","stringify","state","catch","error","alert","response","message","e","map","item","id"],"mappings":"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","sourcesContent":["import { Modal, Button, Form, Row, Col } from 'react-bootstrap'\r\nimport { createProduct, fetchCategories, fetchBrands, fetchMechanisms, fetchGenders } from '../http/catalogAPI.js'\r\nimport { useState, useEffect } from 'react'\r\nimport CreateProperties from './CreateProperties.js'\r\n\r\nconst defaultValue = {name: '', price: '', category: '', brand: '', mechanism: '', gender: '', shape: ''}\r\nconst defaultValid = {name: null, price: null, category: null, brand: null, mechanism: null, gender: null, shape: null}\r\n\r\nconst isValid = (value) => {\r\n    const result = {}\r\n    const pattern = /^[1-9][0-9]*$/\r\n    for (let key in value) {\r\n        if (key === 'name') result.name = value.name.trim() !== ''\r\n        if (key === 'price') result.price = pattern.test(value.price.trim())\r\n        if (key === 'category') result.category = pattern.test(value.category)\r\n        if (key === 'brand') result.brand = pattern.test(value.brand)\r\n        if (key === 'mechanism') result.mechanism = pattern.test(value.mechanism)\r\n        if (key === 'gender') result.gender = pattern.test(value.gender)\r\n        if (key === 'shape') result.shape = pattern.test(value.shape)\r\n    }\r\n    return result\r\n}\r\n\r\nconst CreateProduct = (props) => {\r\n    const { show, setShow, setChange } = props\r\n    const [value, setValue] = useState(defaultValue)\r\n    const [valid, setValid] = useState(defaultValid)\r\n    const [image, setImage] = useState(null)\r\n    const [properties, setProperties] = useState([])\r\n    const [categories, setCategories] = useState(null)\r\n    const [brands, setBrands] = useState(null)\r\n    const [mechanisms, setMechanisms] = useState(null)\r\n    const [genders, setGenders] = useState(null)\r\n    const [shapes, setShapes] = useState(null)\r\n    useEffect(() => {\r\n        fetchCategories()\r\n            .then(\r\n                data => setCategories(data)\r\n            )\r\n        fetchBrands()\r\n            .then(\r\n                data => setBrands(data)\r\n            )\r\n        fetchMechanisms()\r\n            .then(\r\n                data => setMechanisms(data)\r\n            )\r\n        fetchGenders()\r\n            .then(\r\n                data => setGenders(data)\r\n            )\r\n        fetchShapes()\r\n            .then(\r\n                data => setShapes(data)\r\n            )\r\n    }, [])\r\n\r\n    const handleInputChange = (event) => {\r\n        const data = {...value, [event.target.name]: event.target.value}\r\n        setValue(data)\r\n        setValid(isValid(data))\r\n    }\r\n\r\n    const handleImageChange = (event) => {\r\n        setImage(event.target.files[0])\r\n    }\r\n\r\n    const handleSubmit = (event) => {\r\n        event.preventDefault()\r\n\r\n        const correct = isValid(value)\r\n        setValid(correct)\r\n\r\n        if (correct.name && correct.price && correct.category && correct.brand && correct.mechanism && correct.gender && correct.shape) {\r\n\r\n            const data = new FormData()\r\n            data.append('name', value.name.trim())\r\n            data.append('price', value.price.trim())\r\n            data.append('categoryId', value.category)\r\n            data.append('brandId', value.brand)\r\n            data.append('mechanismId', value.mechanism)\r\n            data.append('genderId', value.gender)\r\n            data.append('shapeId', value.shape)\r\n            if (image) data.append('image', image, image.name)\r\n            if (properties.length) {\r\n                const props = properties.filter(\r\n                    prop => prop.name.trim() !== '' && prop.value.trim() !== ''\r\n                )\r\n                if (props.length) {\r\n                    data.append('props', JSON.stringify(props))\r\n                }\r\n            }\r\n\r\n            createProduct(data)\r\n                .then(\r\n                    data => {\r\n                        event.target.image.value = ''\r\n                        setValue(defaultValue)\r\n                        setValid(defaultValid)\r\n                        setProperties([])\r\n                        setShow(false)\r\n                        setChange(state => !state)\r\n                    }\r\n                )\r\n                .catch(\r\n                    error => alert(error.response.data.message)\r\n                )\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Modal show={show} onHide={() => setShow(false)} size=\"lg\">\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Новый товар</Modal.Title>\r\n            </Modal.Header>\r\n\r\n            <Modal.Body>\r\n                <Form noValidate onSubmit={handleSubmit}>\r\n                    <Form.Control\r\n                        name=\"name\"\r\n                        value={value.name}\r\n                        onChange={e => handleInputChange(e)}\r\n                        isValid={valid.name === true}\r\n                        isInvalid={valid.name === false}\r\n                        placeholder=\"Название товара...\"\r\n                        className=\"mb-3\"\r\n                    />\r\n                    <Row className=\"mb-3\">\r\n                        <Col>\r\n                            <Form.Select\r\n                                name=\"category\"\r\n                                value={value.category}\r\n                                onChange={e => handleInputChange(e)}\r\n                                isValid={valid.category === true}\r\n                                isInvalid={valid.category === false}\r\n                            >\r\n                                <option value=\"\">Категория</option>\r\n                                {categories && categories.map(item =>\r\n                                    <option key={item.id} value={item.id}>{item.name}</option>\r\n                                )}\r\n                            </Form.Select>\r\n                        </Col>\r\n                        <Col>\r\n                            <Form.Select\r\n                                name=\"brand\"\r\n                                value={value.brand}\r\n                                onChange={e => handleInputChange(e)}\r\n                                isValid={valid.brand === true}\r\n                                isInvalid={valid.brand === false}\r\n                            >\r\n                                <option value=\"\">Бренд</option>\r\n                                {brands && brands.map(item =>\r\n                                    <option key={item.id} value={item.id}>{item.name}</option>\r\n                                )}\r\n                            </Form.Select>\r\n                        </Col>\r\n                        <Col>\r\n                            <Form.Select\r\n                                name=\"mechanism\"\r\n                                value={value.mechanism}\r\n                                onChange={e => handleInputChange(e)}\r\n                                isValid={valid.mechanism === true}\r\n                                isInvalid={valid.mechanism === false}\r\n                            >\r\n                                <option value=\"\">Тип механизма</option>\r\n                                {mechanisms && mechanisms.map(item =>\r\n                                    <option key={item.id} value={item.id}>{item.name}</option>\r\n                                )}\r\n                            </Form.Select>\r\n                        </Col>\r\n                        <Col>\r\n                            <Form.Select\r\n                                name=\"gender\"\r\n                                value={value.gender}\r\n                                onChange={e => handleInputChange(e)}\r\n                                isValid={valid.gender === true}\r\n                                isInvalid={valid.gender === false}\r\n                            >\r\n                                <option value=\"\">Пол</option>\r\n                                {genders && genders.map(item =>\r\n                                    <option key={item.id} value={item.id}>{item.name}</option>\r\n                                )}\r\n                            </Form.Select>\r\n                        </Col>\r\n                        <Col>\r\n                            <Form.Select\r\n                                name=\"shape\"\r\n                                value={value.shape}\r\n                                onChange={e => handleInputChange(e)}\r\n                                isValid={valid.shape === true}\r\n                                isInvalid={valid.shape === false}\r\n                            >\r\n                                <option value=\"\">Форма корпуса</option>\r\n                                {shapes && shapes.map(item =>\r\n                                    <option key={item.id} value={item.id}>{item.name}</option>\r\n                                )}\r\n                            </Form.Select>\r\n                        </Col>\r\n                    </Row>\r\n                    <Row className=\"mb-3\">\r\n                        <Col>\r\n                            <Form.Control\r\n                                name=\"price\"\r\n                                value={value.price}\r\n                                onChange={e => handleInputChange(e)}\r\n                                isValid={valid.price === true}\r\n                                isInvalid={valid.price === false}\r\n                                placeholder=\"Цена товара...\"\r\n                            />\r\n                        </Col>\r\n                        <Col>\r\n                            <Form.Control\r\n                                name=\"image\"\r\n                                type=\"file\"\r\n                                onChange={e => handleImageChange(e)}\r\n                                placeholder=\"Фото товара...\"\r\n                            />\r\n                        </Col>\r\n                    </Row>\r\n                    <CreateProperties properties={properties} setProperties={setProperties} />\r\n                    <Row>\r\n                        <Col>\r\n                            <Button type=\"submit\">Сохранить</Button>\r\n                        </Col>\r\n                    </Row>\r\n                </Form>\r\n            </Modal.Body>\r\n        </Modal>\r\n    )\r\n}\r\n\r\nexport default CreateProduct"]},"metadata":{},"sourceType":"module"}